{% extends "base.html" %}

{% block title %}{{ book.title }} - My Personal Library{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
    <a href="{{ url_for('books.library') }}" class="text-primary hover:underline mb-4 inline-block">
        ← Back to Library
    </a>

    <div class="bg-white rounded-lg shadow-lg p-8">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="md:col-span-1">
                <img src="{{ book.cover_url }}" alt="{{ book.title }}"
                     class="w-full rounded-lg shadow-md">
            </div>

            <div class="md:col-span-2">
                <h1 class="text-3xl font-serif font-bold text-primary mb-2">{{ book.title }}</h1>
                <p class="text-xl text-gray-700 mb-4">by {{ book.display_author }}</p>

                {% if book.additional_authors %}
                <p class="text-sm text-gray-600 mb-4">
                    Additional authors: {{ book.additional_authors }}
                </p>
                {% endif %}

                <div class="grid grid-cols-2 gap-4 mb-6">
                    {% if book.pages %}
                    <div>
                        <span class="text-sm text-gray-600">Pages:</span>
                        <span class="font-semibold">{{ book.pages }}</span>
                    </div>
                    {% endif %}

                    {% if book.year_published %}
                    <div>
                        <span class="text-sm text-gray-600">Published:</span>
                        <span class="font-semibold">{{ book.year_published }}</span>
                    </div>
                    {% endif %}

                    {% if book.publisher %}
                    <div>
                        <span class="text-sm text-gray-600">Publisher:</span>
                        <span class="font-semibold">{{ book.publisher }}</span>
                    </div>
                    {% endif %}

                    {% if book.binding %}
                    <div>
                        <span class="text-sm text-gray-600">Binding:</span>
                        <span class="font-semibold">{{ book.binding }}</span>
                    </div>
                    {% endif %}

                    {% if book.isbn13 %}
                    <div>
                        <span class="text-sm text-gray-600">ISBN-13:</span>
                        <span class="font-semibold font-mono">{{ book.isbn13 }}</span>
                    </div>
                    {% endif %}

                    {% if book.isbn %}
                    <div>
                        <span class="text-sm text-gray-600">ISBN:</span>
                        <span class="font-semibold font-mono">{{ book.isbn }}</span>
                    </div>
                    {% endif %}
                </div>

                {% if book.reading_record %}
                <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                    <h3 class="font-semibold mb-2">Reading Status</h3>
                    <div class="space-y-2">
                        <div>
                            <span class="inline-block px-3 py-1 rounded
                                {% if book.reading_record.status == 'read' %}bg-green-100 text-green-800
                                {% elif book.reading_record.status == 'currently-reading' %}bg-blue-100 text-blue-800
                                {% else %}bg-gray-100 text-gray-800{% endif %}">
                                {{ book.reading_record.status.replace('-', ' ').title() }}
                            </span>
                        </div>

                        {% if book.reading_record.date_started %}
                        <div>
                            <span class="text-sm text-gray-600">Started:</span>
                            <span>{{ book.reading_record.date_started.strftime('%B %d, %Y') }}</span>
                        </div>
                        {% endif %}

                        {% if book.reading_record.date_finished %}
                        <div>
                            <span class="text-sm text-gray-600">Finished:</span>
                            <span>{{ book.reading_record.date_finished.strftime('%B %d, %Y') }}</span>
                        </div>
                        {% endif %}

                        {% if book.reading_record.read_count > 1 %}
                        <div>
                            <span class="text-sm text-gray-600">Times read:</span>
                            <span>{{ book.reading_record.read_count }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endif %}

                {% if book.review %}
                <div class="mb-6">
                    <h3 class="font-semibold mb-2">My Review</h3>

                    {% if book.review.rating %}
                    <div class="star-rating text-2xl mb-3">
                        {% for i in range(book.review.rating) %}★{% endfor %}{% for i in range(5 - book.review.rating) %}☆{% endfor %}
                    </div>
                    {% endif %}

                    {% if book.review.review_text %}
                    <div class="prose max-w-none bg-gray-50 p-4 rounded-lg">
                        {{ book.review.review_text }}
                    </div>
                    {% endif %}

                    {% if book.review.private_notes %}
                    <div class="mt-4">
                        <h4 class="font-semibold text-sm text-gray-600 mb-2">Private Notes</h4>
                        <div class="text-sm bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                            {{ book.review.private_notes }}
                        </div>
                    </div>
                    {% endif %}
                </div>
                {% endif %}

                {% if book.categories %}
                <div class="mb-6">
                    <h3 class="font-semibold mb-2">Categories</h3>
                    <div class="flex flex-wrap gap-2">
                        {% for category in book.categories %}
                        <span class="px-3 py-1 rounded-full text-sm text-white"
                              style="background-color: {{ category.color }}">
                            {{ category.name }}
                        </span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <div class="text-sm text-gray-500 mt-6">
                    Added on {{ book.date_added.strftime('%B %d, %Y') }}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
